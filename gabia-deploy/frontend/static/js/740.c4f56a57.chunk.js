"use strict";(self.webpackChunkvridge=self.webpackChunkvridge||[]).push([[740],{5053:function(e,n,s){s(7313);n.Z=s.p+"static/media/down_icon.2b55d5de8925064e33a5130f409190a9.svg"},2034:function(e,n,s){var t=s(4942),a=s(1413),i=s(9439),c=s(7313);n.Z=function(e,n){var s=(0,c.useState)(e),r=(0,i.Z)(s,2),l=r[0],o=r[1];return{inputs:l,onChange:function(e){var s=e.target,i=s.name,c=s.value,r=!0;"function"==typeof n&&"description"!=i&&(r=n(c)),r&&o((0,a.Z)((0,a.Z)({},l),{},(0,t.Z)({},i,c)))},set_inputs:o}}},2740:function(e,n,s){s.r(n),s.d(n,{default:function(){return b}});var t=s(1413),a=s(3433),i=s(9439),c=s(7313),r=s(8467),l=(s(9169),s(8061)),o=s(2974),d=s(2034),m=s(7467);var u=s(6417);function h(e){var n=e.project_id,s=e.refetch,t={secret:"",title:"",section:"",contents:""},a=(0,d.Z)(t),i=a.inputs,c=a.onChange,r=a.set_inputs,l=i.secret,o=i.section,h=i.contents;return(0,u.jsxs)("div",{className:"form",children:[(0,u.jsxs)("div",{className:"flex align_center",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("input",{type:"radio",id:"user_type",name:"secret",value:!0,onChange:c,className:"ty02"}),(0,u.jsx)("label",{htmlFor:"user_type",children:"\uc775\uba85"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("input",{type:"radio",id:"user_type2",name:"secret",value:!1,onChange:c,className:"ty02"}),(0,u.jsx)("label",{htmlFor:"user_type2",children:"\uc77c\ubc18"})]})]}),(0,u.jsx)("input",{type:"text",name:"section",value:o,placeholder:"\uad6c\uac04 \uc785\ub825 (EX_ 05:30)",onChange:c,className:"ty01 mt20"}),(0,u.jsx)("input",{type:"text",name:"contents",value:h,placeholder:"\ub0b4\uc6a9 \uc785\ub825",onChange:c,className:"ty01 mt20"}),(0,u.jsx)("button",{onClick:function(){var e,a;l&&o&&h?(e=i,a=n,(0,m.Fi)("put","".concat("https://api.vridge.kr","/feedbacks/").concat(a),e)).then((function(e){window.alert("\ud53c\ub4dc\ubc31 \ub4f1\ub85d\uc774 \ub418\uc5c8\uc2b5\ub2c8\ub2e4."),r(t),document.getElementsByName("secret").forEach((function(e){e.checked=!1})),s()})).catch((function(e){e.response&&e.response.data&&window.alert(e.response.data.message)})):window.alert("\uc785\ub825\ub780\uc744 \ucc44\uc6cc\uc8fc\uc138\uc694.")},className:"submit mt40",children:"\ud53c\ub4dc\ubc31 \ub4f1\ub85d"})]})}function x(e){var n=e.refetch,s=e.current_project,t=e.user;function a(e){var s;(s=e,(0,m.Fi)("delete","".concat("https://api.vridge.kr","/feedbacks/").concat(s))).then((function(e){console.log(e),window.alert("\ud53c\ub4dc\ubc31\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),n()})).catch((function(e){e.response&&e.response.data&&window.alert(e.response.data.message)}))}var i=s.feedback.filter((function(e){return e.email==t}));return(0,u.jsx)("div",{className:"history",children:(0,u.jsx)("ul",{children:i.length>0?i.map((function(e,n){return(0,u.jsx)("li",{children:(0,u.jsxs)("div",{className:"flex align_center space_between",children:[(0,u.jsxs)("div",{className:"txt_box",children:[(0,u.jsx)("div",{className:"time",children:e.section}),(0,u.jsx)("p",{children:e.text})]}),(0,u.jsx)("button",{onClick:function(){return a(e.id)},className:"delete",children:"\uc0ad\uc81c"})]})},n)})):(0,u.jsx)("div",{className:"flex mt50 justify_center",children:"\ud53c\ub4dc\ubc31\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})})})}var f=s(816),j=s.n(f);s(1971);function v(e){var n=e.current_project,s=(0,c.useState)([]),t=(0,i.Z)(s,2),a=t[0],r=t[1],l=(0,c.useState)(null),o=(0,i.Z)(l,2),d=o[0],m=o[1];return(0,c.useEffect)((function(){var e={};n.feedback.forEach((function(n){var s=j()(n.created).format("YYYY.MM.DD.dd");e.hasOwnProperty(s)?e[s].push(n):e[s]=[n]})),r(Object.entries(e))}),[n]),(0,u.jsx)(u.Fragment,{children:a.map((function(e,n){return(0,u.jsxs)("div",{className:"box",children:[(0,u.jsx)("div",{className:"day",children:e[0]}),(0,u.jsx)("ul",{children:e[1].map((function(e,n){return(0,u.jsxs)("li",{className:d&&d.id===e.id?"on":"",onClick:function(){return m(e)},children:[e.section,d&&d.id===e.id&&(0,u.jsxs)("div",{className:"view-container",children:[(0,u.jsx)("div",{className:"view",children:(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"txt_box",children:d.security?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"name",children:"\uc775\uba85"}),(0,u.jsx)("span",{className:"name",children:d.section})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"name",children:d.nickname}),(0,u.jsx)("span",{className:"email",children:d.email})]})}),(0,u.jsx)("div",{className:"comment_box",children:d.text})]})}),(0,u.jsx)("button",{className:"close-button",onClick:function(e){return function(e,n,s){e.stopPropagation(),m(null)}(e)},children:"X"})]})]},n)}))})]},n)}))})}s(6123);function p(e){var n=e.Rating,s=e.ws,t=e.socketConnected,a=e.items,r=e.me,l=(0,c.useRef)(),o=r.email,d=r.nickname,m=r.rating,h=(0,c.useState)(""),x=(0,i.Z)(h,2),f=x[0],j=x[1];function v(){var e=f.replaceAll(" ","");t?e.length>0&&(s.current.send(JSON.stringify({email:o,nickname:d,rating:m,message:f})),j("")):window.alert("\ucc44\ud305 \uc11c\ubc84\uac00 \ubd88\uc548\uc815\ud569\ub2c8\ub2e4. \uc7ac\uc811\uc18d \ud574\uc8fc\uc138\uc694.")}return(0,c.useEffect)((function(){l.current&&l.current.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}),[a]),t&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"comment",children:(0,u.jsx)("ul",{children:a.length>0?a.map((function(e,s){return(0,u.jsxs)("li",{ref:s===a.length-1?l:null,children:[(0,u.jsxs)("div",{className:"flex align_center",children:[(0,u.jsx)("div",{className:"\uad00\ub9ac\uc790"==n(e.rating)?"img_box admin":"img_box basic"}),(0,u.jsxs)("div",{className:"txt_box",children:[(0,u.jsxs)("span",{className:"name",children:[e.nickname,(0,u.jsxs)("small",{className:"\uad00\ub9ac\uc790"==n(e.rating)?"admin":"basic",children:["(",n(e.rating),")"]})]}),(0,u.jsx)("span",{className:"email",children:e.email})]})]}),(0,u.jsx)("div",{className:"comment_box",children:e.message})]},s)})):(0,u.jsx)("li",{className:"empty",children:"\uc6f9\ud398\uc774\uc9c0\ub97c \ub2eb\uc744 \uacbd\uc6b0 \ub300\ud654 \ub0b4\uc6a9\uc740 \uc800\uc7a5\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."})})}),r&&(0,u.jsxs)("div",{className:"pr",children:[(0,u.jsx)("input",{type:"text",value:f,onChange:function(e){return j(e.target.value)},onKeyUp:function(){13==window.event.keyCode&&v()},placeholder:"\ucc44\ud305 \uc785\ub825",className:"ty01",style:{padding:"0 120px 0 15px"}}),(0,u.jsx)("button",{onClick:v,className:"cert",children:"\uc785\ub825"})]})]})}var g=function(e,n){var s=(0,c.useState)(e),t=(0,i.Z)(s,2),a=t[0],r=t[1];if(n&&Array.isArray(n))return{currentItem:n[a],changeItem:r}},N=(s(5053),s(5554));function b(){var e=(0,r.s0)(),n=(0,N.v9)((function(e){return e.ProjectStore})).user,s=(0,r.UO)().project_id,d=(0,c.useState)(0),f=(0,i.Z)(d,2),b=f[0],w=f[1],k=(0,c.useState)(null),y=(0,i.Z)(k,2),C=y[0],Z=y[1],S=(0,c.useMemo)((function(){return!!C&&(n===C.owner_email||C.member_list.filter((function(e,s){return e.email===n&&"manager"===e.rating})).length>0)}),[C,n]),F=function(){w(Date.now())};function E(e){return"manager"===e?"\uad00\ub9ac\uc790":"\uc77c\ubc18"}(0,c.useEffect)((function(){var e;(e=s,(0,m.Fi)("get","".concat("https://api.vridge.kr","/feedbacks/").concat(e))).then((function(e){Z(e.data.result)})).catch((function(e){e.response&&e.response.data&&window.alert(e.response.data.message)}))}),[s,b]);var Y=(0,c.useState)(!1),D=(0,i.Z)(Y,2),I=D[0],M=D[1],O=(0,c.useState)({email:"",nickname:"",rating:""}),R=(0,i.Z)(O,2),A=R[0],J=R[1],L="".concat("wss://api.vridge.kr","/ws/chat/").concat(s,"/"),P=(0,c.useRef)(null),V=(0,c.useState)([]),U=(0,i.Z)(V,2),X=U[0],q=U[1];(0,c.useEffect)((function(){if(C&&n)if(C.owner_email===n)J({email:C.owner_email,nickname:C.owner_nickname,rating:"manager"});else{var e=C.member_list.filter((function(e){return e.email===n}));1===e.length&&(e=e[0],J({email:e.email,nickname:e.nickname,rating:e.rating}))}}),[C,n]),(0,c.useEffect)((function(){return P.current=new WebSocket(L),P.current.onopen=function(){console.log("connected"),M(!0);var e=JSON.parse(window.sessionStorage.getItem("items"));e&&e.id==s?q(e.items):q([])},P.current.onclose=function(e){console.log("disconnect")},P.current.onerror=function(e){console.log("connection error"),console.log(e)},P.current.onmessage=function(e){var n=JSON.parse(e.data);q((function(e){return[].concat((0,a.Z)(e),[n.result])}))},function(){P.current&&P.current.close()}}),[s]),(0,c.useEffect)((function(){if(X.length>0){var e={id:s,items:X};window.sessionStorage.setItem("items",JSON.stringify(e))}}),[X]);var B=[{tab:"\ucf54\uba58\ud2b8",content:C&&(0,u.jsx)(p,{Rating:E,socketConnected:I,ws:P,items:X,me:A})},{tab:"\ud53c\ub4dc\ubc31 \ub4f1\ub85d",content:(0,u.jsx)(h,{project_id:s,refetch:F})},{tab:"\ud53c\ub4dc\ubc31 \uad00\ub9ac",content:C&&(0,u.jsx)(x,{refetch:F,current_project:C,user:n})},{tab:"\uba64\ubc84",content:C&&(0,u.jsx)("div",{className:"member",children:(0,u.jsxs)("ul",{children:[(0,u.jsxs)("li",{className:"admin",children:[(0,u.jsx)("div",{className:"img"}),(0,u.jsxs)("div",{className:"txt",children:[C.owner_nickname,"(\uad00\ub9ac\uc790)",(0,u.jsx)("span",{children:C.owner_email})]})]}),C.member_list.map((function(e,n){return(0,u.jsxs)("li",{className:"manager"===e.rating?"admin":"basic",children:[(0,u.jsx)("div",{className:"img"}),(0,u.jsxs)("div",{className:"txt",children:[e.nickname,"(",E(e.rating),")",(0,u.jsx)("span",{children:e.email})]})]},n)}))]})})},{tab:"\ud504\ub85c\uc81d\ud2b8 \uc815\ubcf4",content:C&&(0,u.jsxs)("div",{className:"info",children:[(0,u.jsxs)("dl",{className:"flex align_center",children:[(0,u.jsx)("dt",{children:"\ub2f4\ub2f9\uc790"}),(0,u.jsx)("dd",{children:C.manager})]}),(0,u.jsxs)("dl",{className:"flex align_center",children:[(0,u.jsx)("dt",{children:"\uace0\uac1d\uc0ac"}),(0,u.jsx)("dd",{children:C.consumer})]}),(0,u.jsxs)("dl",{className:"flex align_center",children:[(0,u.jsx)("dt",{children:"\ud504\ub85c\uc81d\ud2b8 \uc0dd\uc131"}),(0,u.jsx)("dd",{children:j()(C.created).format("YYYY.MM.DD.dd")})]}),(0,u.jsxs)("dl",{className:"flex align_center",children:[(0,u.jsx)("dt",{children:"\ucd5c\uc885 \uc5c5\ub370\uc774\ud2b8"}),(0,u.jsx)("dd",{children:j()(C.updated).format("YYYY.MM.DD.dd")})]}),(0,u.jsxs)("dl",{children:[(0,u.jsx)("dt",{children:"\ud504\ub85c\uc81d\ud2b8 \uc138\ubd80 \uc124\uba85"}),(0,u.jsx)("dd",{className:"mt10",children:C.description})]}),S&&(0,u.jsx)("button",{className:"project_btn",onClick:function(){e("/ProjectEdit/".concat(s))},children:"\ud504\ub85c\uc81d\ud2b8 \uad00\ub9ac"})]})}],K=g(0,B),T=K.currentItem,W=K.changeItem;function z(e){return n===e.owner_email||e.member_list.filter((function(e,s){return e.email===n&&"manager"===e.rating})).length>0}function G(e){var n,t,a=e.target.files[0],i=new FormData;i.append("files",a),window.confirm("\ud30c\uc77c\uc744 \uc5c5\ub85c\ub4dc \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")?(ee(!0),(n=i,t=s,(0,m.Fi)("post","".concat("https://api.vridge.kr","/feedbacks/").concat(t),n,{headers:{"Content-Type":"multipart/form-data"}})).then((function(e){console.log(e),F()})).catch((function(n){e.target.value="",n.response&&n.response.data&&(window.alert(n.response.data.message),ee(!1))}))):e.target.value=""}var H=(0,c.useState)(!1),Q=(0,i.Z)(H,2),$=Q[0],ee=Q[1];return(0,u.jsx)(l.Z,{children:(0,u.jsxs)("div",{className:"cms_wrap",children:[(0,u.jsx)(o.Z,{}),(0,u.jsx)("main",{children:C&&(0,u.jsxs)("div",{className:"content feedback flex space_between",children:[(0,u.jsxs)("div",{className:"videobox",children:[(0,u.jsxs)("div",{className:C.files?"video_inner active":"video_inner",children:[C.files&&(0,u.jsx)(_,{url:C.files,SetVideoLoad:ee}),z(C)&&!C.files&&(0,u.jsxs)("div",{className:"upload_btn_wrap",children:[(0,u.jsx)("input",{type:"file",accept:"video/*",onChange:G,className:"video_upload",id:"files",name:"files"}),(0,u.jsx)("label",{htmlFor:"files",className:"video_upload_label",children:(0,u.jsx)("div",{children:"\uc601\uc0c1 \ucd94\uac00"})})]}),$&&(0,u.jsx)("div",{className:"loading",children:(0,u.jsx)("div",{className:"animation"})})]}),(0,u.jsxs)("div",{className:"etc_box",children:[(0,u.jsxs)("div",{className:"flex space_between align_center",children:[(0,u.jsx)("button",{onClick:function(){return e("/FeedbackAll",{state:(0,t.Z)((0,t.Z)({},C),{},{user:n})})},className:"all",children:"\ud53c\ub4dc\ubc31 \uc804\uccb4 \ubcf4\uae30"}),z(C)&&C.files&&(0,u.jsxs)("div",{className:"good",children:[(0,u.jsxs)("div",{className:"change_btn_wrap",children:[(0,u.jsx)("input",{type:"file",accept:"video/*",onChange:G,name:"files",className:"video_upload",id:"files"}),(0,u.jsx)("label",{htmlFor:"files",className:"video_upload_label",children:(0,u.jsx)("div",{children:"\uad50\uccb4"})})]}),(0,u.jsx)("div",{className:"change_btn_wrap",children:(0,u.jsx)("div",{className:"video_upload_label",children:(0,u.jsx)("div",{onClick:function(){var e;window.confirm("\ud30c\uc77c\uc744 \uc0ad\uc81c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(e=s,(0,m.Fi)("delete","".concat("https://api.vridge.kr","/feedbacks/file/").concat(e))).then((function(e){F()})).catch((function(e){e.response&&e.response.data&&window.alert(e.response.data.message)}))},className:"delete",children:"\uc0ad\uc81c"})})})]}),(0,u.jsx)("div",{onClick:function(){return function(e){var n=document.createElement("textarea");document.body.appendChild(n),n.value=e,n.select(),document.execCommand("copy"),document.body.removeChild(n),window.alert("\ub9c1\ud06c\uac00 \ubcf5\uc0ac\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}(C.files)},className:"share",children:"\uacf5\uc720"})]}),(0,u.jsx)("div",{className:"list",children:(0,u.jsx)(v,{current_project:C})})]})]}),(0,u.jsxs)("div",{className:"sidebox",children:[(0,u.jsx)("div",{className:"b_title",children:(0,u.jsx)("div",{className:"s_title",children:T.tab})}),(0,u.jsxs)("div",{className:"top_box",children:[(0,u.jsx)("ul",{className:"tab_menu",children:B.map((function(e,n){return(0,u.jsx)("li",{className:T.tab==e.tab?"active":"",onClick:function(){return W(n)},children:e.tab},n)}))}),(0,u.jsx)("div",{className:"edit"})]}),(0,u.jsx)("div",{className:"tab_content",children:T.content})]})]})})]})})}var _=c.memo((function(e){var n=e.url,s=e.SetVideoLoad,t=(0,c.useRef)();return(0,c.useEffect)((function(){var e;null===(e=t.current)||void 0===e||e.load()}),[n]),(0,u.jsxs)("video",{controls:!0,width:"100%",height:"100%",ref:t,controlsList:"nodownload",src:n,onLoadedData:function(){s(!1)},children:[(0,u.jsx)("source",{src:n,type:"video/mp4"}),(0,u.jsx)("source",{src:n,type:"video/webm"}),(0,u.jsx)("source",{src:n,type:"video/quicktime"}),(0,u.jsx)("source",{src:n,type:"video/ogg"}),(0,u.jsx)("source",{src:n,type:"video/x-mplayer2"}),(0,u.jsx)("source",{src:n,type:"video/x-msvideo"}),(0,u.jsx)("source",{src:n})]})}))}}]);